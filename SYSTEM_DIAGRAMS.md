# システム図表集

## 🏗️ システム全体アーキテクチャ

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              My Routine App                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐        │
│  │   Presentation  │    │   Business      │    │   Data Access   │        │
│  │     Layer       │    │     Logic       │    │     Layer       │        │
│  │                 │    │                 │    │                 │        │
│  │ • HTML/CSS      │◄──►│ • Auth Logic    │◄──►│ • LocalStorage  │        │
│  │ • UI Components │    │ • Data Mgmt     │    │ • Firebase      │        │
│  │ • Event Handlers│    │ • Business Rules│    │ • Google Drive  │        │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘        │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 🔄 データフロー図

### 認証フロー
```
User Input
    │
    ▼
┌─────────────┐
│   UI Layer  │
│             │
│ Login Form  │
└─────────────┘
    │
    ▼
┌─────────────┐
│ Auth Ctrl   │
│             │
│ handleLogin │
└─────────────┘
    │
    ▼
┌─────────────┐
│ SimpleAuth  │
│             │
│ signIn()    │
└─────────────┘
    │
    ▼
┌─────────────┐
│LocalStorage │
│             │
│ User Data   │
└─────────────┘
    │
    ▼
┌─────────────┐
│ Main App    │
│             │
│ Dashboard   │
└─────────────┘
```

### データ同期フロー
```
Local Changes
    │
    ▼
┌─────────────┐
│ Data Mgmt   │
│             │
│ saveData()  │
└─────────────┘
    │
    ▼
┌─────────────┐
│ LocalStorage│
│             │
│ Save Local  │
└─────────────┘
    │
    ▼
┌─────────────┐
│ Firebase    │
│             │
│ Sync Cloud  │
└─────────────┘
    │
    ▼
┌─────────────┐
│ Conflict    │
│ Resolution  │
│             │
└─────────────┘
```

## 📊 コンポーネント関係図

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              Component Relationships                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────┐                                                    │
│  │   index.html    │                                                    │
│  │                 │                                                    │
│  │ • Entry Point   │                                                    │
│  │ • UI Structure  │                                                    │
│  │ • Script Loader │                                                    │
│  └─────────────────┘                                                    │
│           │                                                              │
│           ▼                                                              │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐        │
│  │ script-new.js   │    │ simple-auth.js  │    │ firebase-config │        │
│  │                 │    │                 │    │ .js             │        │
│  │ • Auth Ctrl     │◄──►│ • SimpleAuth    │◄──►│ • Firebase      │        │
│  │ • UI Logic      │    │ • User Mgmt     │    │ • Config        │        │
│  │ • Data Mgmt     │    │ • Password Hash │    │ • Auth Provider │        │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘        │
│           │                       │                       │                │
│           ▼                       ▼                       ▼                │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐        │
│  │ simple-storage  │    │ LocalStorage    │    │ Firebase        │        │
│  │ .js             │    │                 │    │ Firestore       │        │
│  │                 │    │ • User Data     │    │                 │        │
│  │ • Storage Logic │◄──►│ • Auth State    │◄──►│ • Cloud Data    │        │
│  │ • Sync Logic    │    │ • App Data      │    │ • Real-time     │        │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘        │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 🔐 セキュリティアーキテクチャ

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              Security Layers                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                        Application Layer                            │   │
│  │                                                                     │   │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐            │   │
│  │  │ Input       │    │ Business    │    │ Output      │            │   │
│  │  │ Validation  │    │ Logic       │    │ Sanitization│            │   │
│  │  └─────────────┘    └─────────────┘    └─────────────┘            │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                        Authentication Layer                         │   │
│  │                                                                     │   │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐            │   │
│  │  │ Password    │    │ Session     │    │ Access      │            │   │
│  │  │ Hashing     │    │ Management  │    │ Control     │            │   │
│  │  └─────────────┘    └─────────────┘    └─────────────┘            │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                          Data Layer                                 │   │
│  │                                                                     │   │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐            │   │
│  │  │ Data        │    │ Encryption  │    │ Backup      │            │   │
│  │  │ Validation  │    │ (Future)    │    │ Security    │            │   │
│  │  └─────────────┘    └─────────────┘    └─────────────┘            │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 📱 UI/UX コンポーネント階層

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              UI Component Hierarchy                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                            App Container                            │   │
│  │                                                                     │   │
│  │  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐ │   │
│  │  │   Auth View     │    │   Main View     │    │  Register View  │ │   │
│  │  │                 │    │                 │    │                 │ │   │
│  │  │ • Login Form    │    │ • Dashboard     │    │ • Register Form │ │   │
│  │  │ • Error Display │    │ • Routine List  │    │ • Validation    │ │   │
│  │  │ • Loading State │    │ • Add Routine   │    │ • Success Msg   │ │   │
│  │  └─────────────────┘    └─────────────────┘    └─────────────────┘ │   │
│  │           │                       │                       │           │   │
│  │           ▼                       ▼                       ▼           │   │
│  │  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐ │   │
│  │  │ Form Components │    │ Routine Items   │    │ Modal Dialogs   │ │   │
│  │  │                 │    │                 │    │                 │ │   │
│  │  │ • Input Fields  │    │ • Routine Card  │    │ • Add Modal     │ │   │
│  │  │ • Buttons       │    │ • Complete Btn  │    │ • Edit Modal    │ │   │
│  │  │ • Validation    │    │ • Frequency Tag │    │ • Delete Modal  │ │   │
│  │  └─────────────────┘    └─────────────────┘    └─────────────────┘ │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 🔄 状態管理フロー

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              State Management Flow                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  Initial State                                                             │
│       │                                                                     │
│       ▼                                                                     │
│  ┌─────────────┐                                                           │
│  │ App Load    │                                                           │
│  │             │                                                           │
│  │ • Check Auth│                                                           │
│  │ • Load Data │                                                           │
│  └─────────────┘                                                           │
│       │                                                                     │
│       ▼                                                                     │
│  ┌─────────────┐                                                           │
│  │ Auth State  │                                                           │
│  │             │                                                           │
│  │ • Logged In │                                                           │
│  │ • Logged Out│                                                           │
│  └─────────────┘                                                           │
│       │                                                                     │
│       ▼                                                                     │
│  ┌─────────────┐                                                           │
│  │ Data State  │                                                           │
│  │             │                                                           │
│  │ • Routines  │                                                           │
│  │ • Completions│                                                          │
│  └─────────────┘                                                           │
│       │                                                                     │
│       ▼                                                                     │
│  ┌─────────────┐                                                           │
│  │ UI State    │                                                           │
│  │             │                                                           │
│  │ • Loading   │                                                           │
│  │ • Error     │                                                           │
│  │ • Success   │                                                           │
│  └─────────────┘                                                           │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 🧪 テストアーキテクチャ

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              Testing Architecture                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐        │
│  │   Unit Tests    │    │ Integration     │    │ End-to-End      │        │
│  │                 │    │ Tests           │    │ Tests           │        │
│  │ • Auth Logic    │    │ • API Testing   │    │ • User Flows    │        │
│  │ • Data Mgmt     │    │ • Component     │    │ • Full Scenarios│        │
│  │ • Validation    │    │ Integration     │    │ • Cross Browser │        │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘        │
│           │                       │                       │                │
│           ▼                       ▼                       ▼                │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐        │
│  │ Performance     │    │ Security Tests  │    │ Accessibility   │        │
│  │ Tests           │    │                 │    │ Tests           │        │
│  │                 │    │ • Auth Security │    │                 │        │
│  │ • Load Testing  │    │ • Data Security │    │ • Screen Reader │        │
│  │ • Memory Usage  │    │ • Input Validation│  │ • Keyboard Nav  │        │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘        │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 📊 パフォーマンス最適化戦略

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           Performance Optimization                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐        │
│  │   Caching       │    │   Lazy Loading  │    │   Code Splitting│        │
│  │   Strategy      │    │                 │    │                 │        │
│  │                 │    │                 │    │                 │        │
│  │ • Auth State    │    │ • On-Demand     │    │ • Module        │        │
│  │ • User Data     │    │ • Components    │    │ • Bundles       │        │
│  │ • App Data      │    │ • Data Loading  │    │ • Dynamic Imports│       │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘        │
│           │                       │                       │                │
│           ▼                       ▼                       ▼                │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐        │
│  │ Memory          │    │ Network         │    │ Rendering       │        │
│  │ Management      │    │ Optimization    │    │ Optimization    │        │
│  │                 │    │                 │    │                 │        │
│  │ • Cleanup       │    │ • Compression   │    │ • Virtual DOM   │        │
│  │ • Garbage       │    │ • Minification  │    │ • Efficient     │        │
│  │   Collection    │    │ • CDN Usage     │    │   Updates       │        │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘        │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 🔮 将来の拡張計画

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              Future Roadmap                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  Phase 1 (Current)                    Phase 2 (Next)                       │
│  ┌─────────────────┐                ┌─────────────────┐                    │
│  │ • Basic Auth    │                │ • OAuth Support │                    │
│  │ • Local Storage │                │ • MFA           │                    │
│  │ • Firebase Sync │                │ • Advanced UI   │                    │
│  └─────────────────┘                └─────────────────┘                    │
│           │                                   │                            │
│           ▼                                   ▼                            │
│  Phase 3 (Future)                    Phase 4 (Advanced)                    │
│  ┌─────────────────┐                ┌─────────────────┐                    │
│  │ • PWA Support   │                │ • AI Features   │                    │
│  │ • Offline Mode  │                │ • Analytics     │                    │
│  │ • Mobile App    │                │ • Advanced Sync │                    │
│  └─────────────────┘                └─────────────────┘                    │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 📋 実装優先度マトリックス

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              Implementation Priority Matrix                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  High Priority (Must Have)          Medium Priority (Should Have)          │
│  ┌─────────────────┐                ┌─────────────────┐                    │
│  │ • User Auth     │                │ • Data Export   │                    │
│  │ • Basic CRUD    │                │ • Notifications │                    │
│  │ • Data Sync     │                │ • Advanced UI   │                    │
│  │ • Error Handling│                │ • Performance   │                    │
│  └─────────────────┘                └─────────────────┘                    │
│           │                                   │                            │
│           ▼                                   ▼                            │
│  Low Priority (Could Have)           Future (Won't Have)                   │
│  ┌─────────────────┐                ┌─────────────────┐                    │
│  │ • Social Login  │                │ • AI Assistant  │                    │
│  │ • Dark Mode     │                │ • Voice Control │                    │
│  │ • Custom Themes │                │ • AR Features   │                    │
│  │ • Advanced Stats│                │ • Blockchain    │                    │
│  └─────────────────┘                └─────────────────┘                    │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 📝 図表の凡例

### 記号の説明
- `┌─┐` : コンポーネント/モジュール
- `│` : データフロー/関係
- `◄──►` : 双方向通信
- `▼` : 処理の流れ
- `└─┘` : 終了/結果

### 色の意味
- **青**: コア機能
- **緑**: 成功/完了
- **赤**: エラー/警告
- **黄**: 注意/待機
- **紫**: 拡張機能

### 線の種類
- **実線**: 直接的な関係
- **破線**: 間接的な関係
- **点線**: 将来の関係
- **太線**: 重要な関係